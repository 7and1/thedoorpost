name = "doorpost-worker"
main = "src/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

# Browser Rendering API
[browser]
binding = "MYBROWSER"

# R2 bucket
[[r2_buckets]]
binding = "MY_BUCKET"
bucket_name = "doorpost-snapshots"
preview_bucket_name = "doorpost-snapshots-dev"

# D1 database
[[d1_databases]]
binding = "DB"
database_name = "doorpost-db"
database_id = "339326be-3bf0-400a-827c-f429d365c4bd"

# KV namespace
[[kv_namespaces]]
binding = "KV"
id = "77f1b03891bb4acda3d11765c97f9f0e"
preview_id = "77f1b03891bb4acda3d11765c97f9f0e"

[vars]
OPENAI_MODEL = "gpt-4o"
R2_PUBLIC_BASE_URL = "https://r2.thedoorpost.com"
JOB_TTL_SECONDS = "3600"
REPORT_CACHE_TTL_SECONDS = "172800"
ENABLE_DOH_CHECK = "true"
OPENAI_STREAM = "true"
RATE_LIMIT_IP_PER_MIN = "10"
RATE_LIMIT_EMAIL_PER_MIN = "5"
